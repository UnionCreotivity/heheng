<!DOCTYPE html>
<html lang="zh-tw">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./css/all.css" />
    <title>最新消息</title>
  </head>
  <body>
    <nav id="nav"></nav>
    <main id="last-news">
      <section class="cut-1">
        <div class="cut-1-left">
          <div class="cut-1-left-container">
            <div class="cut-1-left-banner">
              <picture>
                <source
                  media="(max-width:1024px)"
                  srcset="./img/last-news/cut-1-L-ph.webp"
                />
                <img src="./img/last-news/banner-L.webp" alt="banner-L" />
              </picture>
            </div>
            <div class="cut-1-left-para">
              <div class="cut-1-left-para-second">
                <h1 class="cut-1-left-para-second-h1">Least</h1>
                <h4 class="cut-1-left-para-second-h4 pc">最新消息</h4>
                <div class="cut-1-left-para-line-second ph"></div>
              </div>
              <div class="cut-1-left-para-first">
                <div class="cut-1-left-para-line pc"></div>
                <h4 class="cut-1-left-para-first-h4 ph">
                  最新消息
                  <div class="bottom-line ph"></div>
                </h4>
                <h1 class="cut-1-left-para-first-h1">News</h1>
              </div>
            </div>
          </div>
        </div>
        <div class="cut-1-right">
          <div class="cut-1-fixed-img">
            <picture>
              <source
                media="(max-width:1024px )"
                srcset="./img/last-news/cut-2-right-fixed-img-ph.webp"
              />
              <img
                src="./img/last-news/cut-1-right-fixed@2x.webp"
                alt="cut-1-right-fixed"
              />
            </picture>
          </div>
        </div>
      </section>
      <section class="cut-2">
        <div class="cut-2-left-fixed-img">
          <img
            src="./img/last-news/cut-2-left-fixed-img.webp"
            alt="right-fixed-line@2x.webp"
          />
        </div>
        <div class="cut-2-container">
          <div class="cut-2-news-line"></div>
          <div class="cut-2-news-main">
            <div class="cut-2-news-item">
              <div class="cut-2-news-item-img">
                <div class="cut-2-news-item-img-pic">
                  <img
                    src="./img/last-news/least-news-pic-1.webp"
                    alt="least-news-pic-1"
                  />
                  <div class="cut-2-news-item-img-pic-ani-white"></div>
                </div>
                <a class="cut-2-news-item-img-back" href="Last_News-inner.html">
                  <div class="cut-2-news-item-img-back-circle">more</div>
                </a>
              </div>
              <div class="cut-2-news-item-para">
                <p class="cut-2-news-item-para-time">Sep 28,2023</p>
                <h3 class="cut-2-news-item-para-title">
                  看準芝山站珍稀性 士林高端客錢進「恆合芝山」
                </h3>
              </div>
            </div>
            <div class="cut-2-news-item">
              <div class="cut-2-news-item-img">
                <div class="cut-2-news-item-img-pic">
                  <img
                    src="./img/last-news/least-news-pic-2.webp"
                    alt="least-news-pic-1"
                  />
                  <div class="cut-2-news-item-img-pic-ani-white"></div>
                </div>
                <a class="cut-2-news-item-img-back" href="Last_News-inner.html">
                  <div class="cut-2-news-item-img-back-circle">more</div>
                </a>
              </div>
              <div class="cut-2-news-item-para">
                <p class="cut-2-news-item-para-time">Sep 28,2023</p>
                <h3 class="cut-2-news-item-para-title">
                  北市公布111年第3季房市指標溫度計 供需略有升溫
                </h3>
              </div>
            </div>
            <div class="cut-2-news-item">
              <div class="cut-2-news-item-img">
                <div class="cut-2-news-item-img-pic">
                  <img
                    src="./img/last-news/least-news-pic-3.webp"
                    alt="least-news-pic-1"
                  />
                  <div class="cut-2-news-item-img-pic-ani-white"></div>
                </div>
                <a class="cut-2-news-item-img-back" href="Last_News-inner.html">
                  <div class="cut-2-news-item-img-back-circle">more</div>
                </a>
              </div>
              <div class="cut-2-news-item-para">
                <p class="cut-2-news-item-para-time">Sep 28,2023</p>
                <h3 class="cut-2-news-item-para-title">
                  住展：北部新屋銷售速度趨緩 仍逾5成 多空分水嶺
                </h3>
              </div>
            </div>
            <div class="cut-2-news-item">
              <div class="cut-2-news-item-img">
                <div class="cut-2-news-item-img-pic">
                  <img
                    src="./img/last-news/least-news-pic-4.webp"
                    alt="least-news-pic-1"
                  />
                  <div class="cut-2-news-item-img-pic-ani-white"></div>
                </div>
                <a class="cut-2-news-item-img-back" href="Last_News-inner.html">
                  <div class="cut-2-news-item-img-back-circle">more</div>
                </a>
              </div>
              <div class="cut-2-news-item-para">
                <p class="cut-2-news-item-para-time">Sep 28,2023</p>
                <h3 class="cut-2-news-item-para-title">
                  東區門戶計畫指標 南港之心環評二 度闖關成功
                </h3>
              </div>
            </div>
          </div>
        </div>
        <div class="load-more"><button type="button">Learn More</button></div>
      </section>
    </main>
    <div class="last-news-right-fixed-L">
      <img
        src="./img/last-news/last-news-right-fixed-L.webp"
        alt="right-fixed"
      />
    </div>
    <div class="last-news-right-fixed-line">
      <img src="./img/last-news/right-fixed-line@2x.webp" alt="right-fixed" />
    </div>
    <footer id="footer">
      <span>Copyright © <span class="year">2024</span>恆合機構版權所有</span
      ><span>地址：231台灣新店區寶橋路140巷11號11樓</span
      ><span>TEL： 02-2910-8718</span>
    </footer>
    <script src="./js/jquery/jquery-3.7.1.min.js"></script>
    <script
      src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"
      integrity="sha256-lSjKY0/srUM9BE3dPm+c4fBo1dky2v27Gdjm2uoZaL0="
      crossorigin="anonymous"
    ></script>
    <script src="./js/nav.js"></script>
    <script src="./js/gsap/gsap.min.js"></script>
    <script src="./js/gsap/ScrollTrigger.min.js"></script>
    <script src="./js/gsap/SplitText.min.js"></script>
    <script>
      const testContent = [
        {
          img: "./img/last-news/least-news-pic-4.webp",
          href: "Last_News-inner.html",
          time: "Sep 28,2023",
          title: "東區門戶計畫指標 南港之心環評二 度闖關成功",
        },
        {
          img: "./img/last-news/least-news-pic-1.webp",
          href: "Last_News-inner.html",
          time: "Sep 28,2023",
          title: "看準芝山站珍稀性 士林高端客錢進「恆合芝山」",
        },
        {
          img: "./img/last-news/least-news-pic-2.webp",
          href: "Last_News-inner.html",
          time: "Sep 28,2023",
          title: "北市公布111年第3季房市指標溫度計 供需略有升溫",
        },
        {
          img: "./img/last-news/least-news-pic-3.webp",
          href: "Last_News-inner.html",
          time: "Sep 28,2023",
          title: "住展：北部新屋銷售速度趨緩 仍逾5成 多空分水嶺",
        },
      ];
      $(document).ready(function () {
        if (window.innerWidth <= 1024) {
          $(".pc").remove();
        } else {
          $(".ph").remove();
        }
      });
      $(window).on("load", function () {
        gsap.registerPlugin(ScrollTrigger, SplitText);

        //動畫延遲
        function addDelay(tag, tag1, tag2, tag3) {
          let delay = 300;
          $(tag).each(function (index) {
            $(this).css("animation-delay", `${delay}ms`);
            delay += 100;
          });
          $(tag1).each(function (index) {
            $(this).css("animation-delay", `${delay}ms`);
            delay += 100;
          });
          $(tag2).each(function (index) {
            $(this).css("animation-delay", `${delay}ms`);
            delay += 100;
          });
          $(tag3).each(function (index) {
            $(this).css("animation-delay", `${delay}ms`);
            delay += 100;
          });
        }

        const titleSplit = new SplitText(
          ".cut-1-left-para-first h1,.cut-1-left-para-second h4,.cut-1-left-para-second h1,.cut-1-left-para-first-h4",
          {
            type: "chars",
          }
        );
        if (window.innerWidth > 1024) {
          addDelay(
            ".cut-1-left-para-second-h1 div",
            ".cut-1-left-para-second-h4 div",
            ".cut-1-left-para-first-h1 div"
          );
        } else {
          addDelay(
            ".cut-1-left-para-second-h1 div",
            ".cut-1-left-para-first-h4 div",
            ".cut-1-left-para-first-h1 div"
          );
        }

        //大標題文字動畫
        let cut1Tl = gsap.timeline({ delay: 0.5 });
        if (window.innerWidth > 1024) {
          gsap.from(titleSplit.chars, {
            stagger: 0.1,
            rotation: "40",
            x: "-110%",
            duration: 1,
            delay: 0.5,
          });
        } else {
          gsap.from(titleSplit.chars, {
            stagger: 0.1,
            rotation: "40",
            y: "140%",
            duration: 1,
            delay: 0.5,
          });
        }

        let all = 0; //掛載id gasp動畫用
        $(".cut-2-news-item").each(function () {
          $(this).attr("id", `news-item-${all}`);
          all++;
        });

        let count = 0; //計數器 渲染項目用
        $(".load-more button").on("click", function () {
          for (let i = 0; i < 2; i++) {
            //點擊一次渲染的數量
            //不用i，而是用count來呈現哪一個內容
            $(".cut-2-news-main").append(`
          <div class="cut-2-news-item" id='news-item-${all}'>
              <div class="cut-2-news-item-img">
                <div class="cut-2-news-item-img-pic">
                <img
                  src=${testContent[count].img}
                  alt="least-news-pic"
                />
                <div class="cut-2-news-item-img-pic-ani-white"></div>
                </div>
                <a class="cut-2-news-item-img-back" href=${testContent[count].href}>
                  <div class="cut-2-news-item-img-back-circle">more</div>
                </a>
              </div>
              <div class="cut-2-news-item-para">
                <p class="cut-2-news-item-para-time">${testContent[count].time}</p>
                <h3 class="cut-2-news-item-para-title">${testContent[count].title}
                </h3>
              </div>
            </div>
          `);
            let direction;
            if (window.innerWidth > 1024) {
              if (all % 2 === 1) {
                direction = -100;
              } else {
                direction = 100;
              }
            } else {
              direction = 100;
            }
            lastNewsAnimation(`#news-item-${all}`, direction);
            all++;
            count++; //count計數器+1
          }
          if (count >= testContent.length) {
            $(".load-more").remove(); //超過資料長度刪除新增按鈕
          }
        });
        if (window.innerWidth > 1024) {
          lastNewsAnimation(".cut-2-news-item:even", 100);
          lastNewsAnimation(".cut-2-news-item:odd", -100);
        } else {
          lastNewsAnimation(".cut-2-news-item", 100);
        }
        function lastNewsAnimation(selector, xVal) {
          $(selector).each(function () {
            let thisId = $(this)[0].id;
            if (window.innerWidth > 1024) {
              gsap.to(`#${thisId} .cut-2-news-item-img-pic-ani-white`, {
                scrollTrigger: {
                  trigger: `#${thisId}`,
                  toggleActions: "play none none none",
                  start: "top center",
                },
                x: "-250%",
                duration: 1.75,
                ease: "power2.out",
              });
            } else {
              gsap.from(`#${thisId}`, {
                scrollTrigger: {
                  trigger: `#${thisId}`,
                  toggleActions: "play none none none",
                  start: "center 60%",
                },
                opacity: 0,
                x: xVal,
                duration: 2,
              });
            }
          });
        }
      });
    </script>
  </body>
</html>
